/**
 * ProseMirror Editor Styles
 *
 * Provides page-like layout similar to Word/Google Docs
 */

/* Editor container */
.prosemirror-editor {
  background: var(--doc-bg);
  padding: 20px;
  min-height: 100%;
  display: flex;
  flex-direction: column;
  align-items: center;
}

/* Editor content area (the actual editable content) */
.prosemirror-editor .ProseMirror {
  background: white;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.15);
  /* Use CSS variables for page layout, with fallbacks */
  width: var(--page-width, 8.5in);
  /* min-height creates a single page appearance */
  min-height: var(--page-height, 11in);
  padding-top: var(--margin-top, 72px);
  padding-bottom: var(--margin-bottom, 72px);
  padding-left: var(--margin-left, 72px);
  padding-right: var(--margin-right, 72px);
  max-width: 100%;
  outline: none;
  /* Default font - will be overridden by inline styles from DOCX */
  font-family: 'Calibri', 'Arial', sans-serif;
  font-size: 11pt;
  /* DO NOT set line-height here - it overrides inline paragraph styles */
  /* line-height is set per-paragraph via inline styles from paragraphAttrsToDOMStyle */
  color: #000;
  white-space: pre-wrap;
  word-wrap: break-word;
  /* Tab size for proper tab character rendering (0.5 inch = 48px at 96dpi) */
  tab-size: 48;
  -moz-tab-size: 48;
  /* Ensure box-sizing includes padding in width calculation */
  box-sizing: border-box;
  /* Page break behavior - show page breaks visually */
  position: relative;
}

/* ============================================================================
   PAGE BREAK STYLES - Visual page boundaries like Word/Google Docs
   ============================================================================ */

/* Page break indicator - inserted by PageBreakPlugin */
.prosemirror-editor .ProseMirror .docx-page-break {
  display: block;
  position: relative;
  height: 40px;
  margin: 0 calc(-1 * var(--margin-left, 72px));
  margin-right: calc(-1 * var(--margin-right, 72px));
  background: var(--doc-bg);
  border: none;
  pointer-events: none;
}

/* Top shadow of next page */
.prosemirror-editor .ProseMirror .docx-page-break::before {
  content: '';
  position: absolute;
  bottom: 0;
  left: 0;
  right: 0;
  height: 8px;
  background: linear-gradient(to bottom, transparent, rgba(0, 0, 0, 0.08));
}

/* Bottom shadow of previous page */
.prosemirror-editor .ProseMirror .docx-page-break::after {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  height: 8px;
  background: linear-gradient(to top, transparent, rgba(0, 0, 0, 0.08));
}

/* Explicit page break (from DOCX pageBreakBefore) */
.prosemirror-editor .ProseMirror [data-page-break-before='true'] {
  break-before: page;
}

/* Page break dashed line indicator (alternative style) */
.prosemirror-editor .ProseMirror .docx-page-break-line {
  display: block;
  position: relative;
  height: 1px;
  margin: 20px calc(-1 * var(--margin-left, 72px));
  margin-right: calc(-1 * var(--margin-right, 72px));
  border-top: 1px dashed var(--doc-border);
}

.prosemirror-editor .ProseMirror .docx-page-break-line::before {
  content: 'Page Break';
  position: absolute;
  top: -10px;
  left: 50%;
  transform: translateX(-50%);
  background: var(--doc-bg);
  padding: 0 8px;
  font-size: 10px;
  color: var(--doc-text-muted);
  white-space: nowrap;
}

/* Focus state */
.prosemirror-editor .ProseMirror:focus {
  outline: none;
}

/* Paragraphs - ensure they display as blocks with proper spacing */
/* IMPORTANT: Do NOT set margin, line-height, or font here - use inline styles from DOCX */
.prosemirror-editor .ProseMirror p {
  display: block;
  /* Default margin only when no inline style is set */
  margin: 0;
  padding: 0;
  min-height: 1em;
  white-space: pre-wrap;
  word-wrap: break-word;
  /* Default line height - can be overridden by inline styles */
  line-height: normal;
}

/* Empty paragraph placeholder */
.prosemirror-editor .ProseMirror p:empty::before {
  content: '\00a0';
}

/* Inline spans for formatting - ensure they don't break layout */
.prosemirror-editor .ProseMirror span {
  display: inline;
  white-space: pre-wrap;
}

/* List styles */
.prosemirror-editor .ProseMirror .docx-list-bullet,
.prosemirror-editor .ProseMirror .docx-list-numbered {
  position: relative;
  padding-left: 36px;
}

.prosemirror-editor .ProseMirror .docx-list-bullet::before {
  content: 'â€¢';
  position: absolute;
  left: 12px;
}

.prosemirror-editor .ProseMirror .docx-list-numbered {
  counter-increment: list-counter;
}

/* Default numbered list (decimal) */
.prosemirror-editor .ProseMirror .docx-list-decimal::before {
  content: counter(list-counter) '.';
  position: absolute;
  left: 12px;
}

/* Roman numeral lists */
.prosemirror-editor .ProseMirror .docx-list-lower-roman::before {
  content: counter(list-counter, lower-roman) '.';
  position: absolute;
  left: 12px;
}
.prosemirror-editor .ProseMirror .docx-list-upper-roman::before {
  content: counter(list-counter, upper-roman) '.';
  position: absolute;
  left: 12px;
}

/* Alphabetic lists */
.prosemirror-editor .ProseMirror .docx-list-lower-alpha::before {
  content: counter(list-counter, lower-alpha) '.';
  position: absolute;
  left: 12px;
}
.prosemirror-editor .ProseMirror .docx-list-upper-alpha::before {
  content: counter(list-counter, upper-alpha) '.';
  position: absolute;
  left: 12px;
}

/* Reset counter at level 0 */
.prosemirror-editor .ProseMirror .docx-list-level-0:first-of-type {
  counter-reset: list-counter;
}

/* Indent levels */
.prosemirror-editor .ProseMirror .docx-list-level-1 {
  margin-left: 0.5in;
}
.prosemirror-editor .ProseMirror .docx-list-level-2 {
  margin-left: 1in;
}
.prosemirror-editor .ProseMirror .docx-list-level-3 {
  margin-left: 1.5in;
}
.prosemirror-editor .ProseMirror .docx-list-level-4 {
  margin-left: 2in;
}
.prosemirror-editor .ProseMirror .docx-list-level-5 {
  margin-left: 2.5in;
}
.prosemirror-editor .ProseMirror .docx-list-level-6 {
  margin-left: 3in;
}
.prosemirror-editor .ProseMirror .docx-list-level-7 {
  margin-left: 3.5in;
}
.prosemirror-editor .ProseMirror .docx-list-level-8 {
  margin-left: 4in;
}

/* Selection styling */
.prosemirror-editor .ProseMirror ::selection {
  background: rgba(66, 133, 244, 0.3);
}

/* Placeholder styling */
.prosemirror-editor[data-placeholder]::before {
  content: attr(data-placeholder);
  color: #aaa;
  position: absolute;
  pointer-events: none;
}

/* Image styling */
.prosemirror-editor .ProseMirror img {
  max-width: 100%;
  height: auto;
}

/* Links */
.prosemirror-editor .ProseMirror a {
  color: var(--doc-link);
  text-decoration: underline;
}

.prosemirror-editor .ProseMirror a:hover {
  color: var(--doc-primary-hover);
}

/* Footnote/Endnote references */
.prosemirror-editor .ProseMirror .docx-footnote-ref,
.prosemirror-editor .ProseMirror .docx-endnote-ref {
  color: var(--doc-link, #0066cc);
  cursor: pointer;
  vertical-align: super;
  font-size: smaller;
}

.prosemirror-editor .ProseMirror .docx-footnote-ref:hover,
.prosemirror-editor .ProseMirror .docx-endnote-ref:hover {
  text-decoration: underline;
}

/* Horizontal rule */
.prosemirror-editor .ProseMirror hr {
  border: none;
  border-top: 1px solid #000;
  margin: 12pt 0;
  height: 0;
}

/* ============================================================================
   TABLE STYLES
   ============================================================================ */

/* Table container */
.prosemirror-editor .ProseMirror table.docx-table {
  border-collapse: collapse;
  width: 100%;
  margin: 12pt 0;
  table-layout: fixed; /* Critical for maintaining column widths */
}

/* Table cells */
.prosemirror-editor .ProseMirror td.docx-table-cell,
.prosemirror-editor .ProseMirror th.docx-table-header {
  border: 1px solid var(--doc-border-dark);
  padding: 4px 8px;
  vertical-align: top;
  min-width: 20px;
  /* Text wrapping for fixed table layout */
  word-wrap: break-word;
  overflow-wrap: break-word;
  overflow: hidden;
}

/* Table header cells */
.prosemirror-editor .ProseMirror th.docx-table-header {
  font-weight: bold;
  background-color: var(--doc-bg-subtle);
  text-align: left;
}

/* Cell content - paragraphs inside cells */
.prosemirror-editor .ProseMirror td p,
.prosemirror-editor .ProseMirror th p {
  margin: 0;
  padding: 0;
  min-height: auto;
}

/* First paragraph in cell shouldn't have top margin */
.prosemirror-editor .ProseMirror td p:first-child,
.prosemirror-editor .ProseMirror th p:first-child {
  margin-top: 0;
}

/* Last paragraph in cell shouldn't have bottom margin */
.prosemirror-editor .ProseMirror td p:last-child,
.prosemirror-editor .ProseMirror th p:last-child {
  margin-bottom: 0;
}

/* Selected cell highlight */
.prosemirror-editor .ProseMirror .selectedCell {
  background-color: rgba(66, 133, 244, 0.15);
}

/* Table selection */
.prosemirror-editor .ProseMirror .selectedCell::after {
  content: '';
  position: absolute;
  inset: 0;
  background: rgba(66, 133, 244, 0.1);
  pointer-events: none;
}

/* Nested tables */
.prosemirror-editor .ProseMirror table table {
  margin: 4px 0;
}

/* ============================================================================
   TABLE COLUMN RESIZE
   ============================================================================ */

/* Column resize handle - visible on hover */
.prosemirror-editor .ProseMirror .column-resize-handle {
  position: absolute;
  right: -2px;
  top: 0;
  bottom: 0;
  width: 4px;
  background-color: rgba(66, 133, 244, 0.5);
  cursor: col-resize;
  z-index: 20;
}

/* Make cells position relative for resize handle positioning */
.prosemirror-editor .ProseMirror td.docx-table-cell,
.prosemirror-editor .ProseMirror th.docx-table-header {
  position: relative;
}

/* Cursor change when resizing */
.prosemirror-editor .ProseMirror.resize-cursor {
  cursor: col-resize;
}

/* Hide resize handle when not hovering the table, show on hover */
.prosemirror-editor .ProseMirror table:not(:hover) .column-resize-handle {
  background-color: transparent;
}

.prosemirror-editor .ProseMirror table:hover .column-resize-handle {
  background-color: rgba(66, 133, 244, 0.3);
}

/* Highlight resize handle on direct hover */
.prosemirror-editor .ProseMirror .column-resize-handle:hover {
  background-color: rgba(66, 133, 244, 0.7);
}

/* ============================================================================
   TAB STYLES
   ============================================================================ */

/* Tab character - renders as inline block with minimum width */
.prosemirror-editor .ProseMirror span.docx-tab {
  display: inline-block;
  min-width: 48px; /* 0.5 inch default tab stop */
  white-space: pre;
  /* Align to tab grid using CSS */
  background: transparent;
}

/* Tab leader styles (for future enhancement) */
.prosemirror-editor .ProseMirror span.docx-tab[data-leader='dot']::before {
  content: '...........';
  position: absolute;
  color: inherit;
  white-space: nowrap;
  overflow: hidden;
}

.prosemirror-editor .ProseMirror span.docx-tab[data-leader='hyphen']::before {
  content: '-----------';
  position: absolute;
  color: inherit;
  white-space: nowrap;
  overflow: hidden;
}

.prosemirror-editor .ProseMirror span.docx-tab[data-leader='underscore']::before {
  content: '___________';
  position: absolute;
  color: inherit;
  white-space: nowrap;
  overflow: hidden;
}
